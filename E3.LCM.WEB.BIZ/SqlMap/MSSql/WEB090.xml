<?xml version="1.0" encoding="euc-kr" ?>
<sqlMap namespace="E3.LCM.WEB.BIZ" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >

	<statements>
		<select id="WEB090_COUNT">
			<![CDATA[
		    SELECT COUNT(*) as COUNT
			    FROM [SE_TA_ATTC_DOC_MAN]
				WHERE 1=1
				AND PLANT_ID = #plantId#
				AND TA_ID = #taId#
				AND ACCP_GB = #accpGb#
				AND FILE_TYPE = #fileType#
	    ]]>
		</select>

		<select id="WEB090_SELECT_ITEMS">
			<![CDATA[
			SELECT [PLANT_ID],[TA_ID],[ACCP_GB],[FILE_TYPE],[FILE_NAME],[USE_YN],[REG_ID],[REG_DATE],[MOD_ID],[MOD_DATE]
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.CODE_ID = M.PLANT_ID) PLANT_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.TA_ID) TA_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.ACCP_GB) ACCP_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.FILE_TYPE) FILE_TYPE_NAME
				FROM [SE_TA_ATTC_DOC_MAN] M
				WHERE 1=1
				AND M.USE_YN = 'Y'
				AND M.PLANT_ID = #plantId#
				AND M.TA_ID = #taId#
				AND M.ACCP_GB = #accpGb#
			]]>
			<isNotNull property="fileType">
				<isNotEmpty property="fileType">
					<![CDATA[
					AND M.FILE_TYPE = #fileType#
					]]>
				</isNotEmpty>
			</isNotNull>
			<![CDATA[
			ORDER BY M.[PLANT_ID],M.[TA_ID],M.[ACCP_GB],M.[FILE_TYPE] ASC
			]]>
		</select>

		<select id="WEB090_SELECT">
			<![CDATA[
                SELECT [PLANT_ID],[TA_ID],[ACCP_GB],[FILE_TYPE],[FILE_NAME],[USE_YN],[REG_ID],[REG_DATE],[MOD_ID],[MOD_DATE]
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.CODE_ID = M.PLANT_ID) PLANT_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.TA_ID) TA_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.ACCP_GB) ACCP_NAME
				, (SELECT CODE_NAME FROM E3_CODE C WHERE C.PLANT_ID = M.PLANT_ID AND C.CODE_ID = M.FILE_TYPE) FILE_TYPE_NAME
				FROM [SE_TA_ATTC_DOC_MAN] M
				WHERE 1=1
			]]>
			<isNotNull property="fileType">
				<isNotEmpty property="fileType">
					<![CDATA[
					AND M.PLANT_ID = #plantId#
					]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="fileType">
				<isNotEmpty property="fileType">
					<![CDATA[
					AND M.TA_ID = #taId#
					]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="fileType">
				<isNotEmpty property="fileType">
					<![CDATA[
					AND M.ACCP_GB = #accpGb#
					]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="fileType">
				<isNotEmpty property="fileType">
					<![CDATA[
					AND M.FILE_TYPE = #fileType#
					]]>
				</isNotEmpty>
			</isNotNull>
			<![CDATA[
			ORDER BY M.[PLANT_ID],M.[TA_ID],M.[ACCP_GB],M.[FILE_TYPE] ASC
			]]>
		</select>

		<select id="WEB090_SAVE_CHECK">
			<![CDATA[
              SELECT [PLANT_ID],[TA_ID],[ACCP_GB],[FILE_TYPE]
              FROM SE_TA_ATTC_DOC_MAN
			  WHERE 1=1
				AND PLANT_ID = #plantId#
				AND TA_ID = #taId#
				AND ACCP_GB = #accpGb#
				AND FILE_TYPE = #fileType#
			]]>
		</select>

		<insert id="WEB090_INSERT">
			<![CDATA[
			INSERT INTO SE_TA_ATTC_DOC_MAN
			([PLANT_ID],[TA_ID],[ACCP_GB],[FILE_TYPE],[FILE_NAME],[USE_YN],[REG_ID],[REG_DATE])
			VALUES
			(#plantId#, #taId#, #accpGb#, #fileType#, #fileName#, #useyn#, #LoginedUserID#, GETDATE())
        ]]>
		</insert>

		<update id="WEB090_UPDATE">
			<![CDATA[
            UPDATE SE_TA_ATTC_DOC_MAN SET 
                FILE_NAME=#fileName#
				, USE_YN=#useyn#
                , MOD_ID=#LoginedUserID#
                , MOD_DATE=GETDATE()
            WHERE 1=1
				AND PLANT_ID = #plantId#
				AND TA_ID = #taId#
				AND ACCP_GB = #accpGb#
				AND FILE_TYPE = #fileType#
        ]]>
		</update>

		<delete id="WEB090_DELETE">
			<![CDATA[
                DELETE FROM SE_TA_ATTC_DOC_MAN
                WHERE 1=1
				  AND PLANT_ID = #plantId#
				  AND TA_ID = #taId#
				  AND ACCP_GB = #accpGb#
				  AND FILE_TYPE = #fileType#
            ]]>
		</delete>

	</statements>
</sqlMap>