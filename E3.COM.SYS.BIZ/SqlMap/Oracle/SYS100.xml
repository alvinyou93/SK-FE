<?xml version="1.0" encoding="euc-kr" ?>
<sqlMap namespace="E3.COM.SYS.BIZ" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >

    <statements>
	   <select id="SYS100_COUNT">
	    <![CDATA[
		    SELECT COUNT(*) as COUNT
			  FROM E3_CODE
        where NVL(CODE_CLASS_ID, '') =NVL(#codeClassId#, '')
			  and CODE_ID= #codeId#
	    ]]>
	   </select>
		
      <select id="SYS100_SELECT_CODE">
        <![CDATA[
          SELECT CODE_ID AS value 
	          ,CODE_NAME AS label
          FROM E3_CODE
          WHERE PARENT_ID = #codeId#
          AND CODE_ID <> PARENT_ID
          ORDER BY DISPLAY_SEQ, CODE_NAME, CODE_ID ASC
        ]]>
      </select>

      <select id="SYS100_SELECT">
        <![CDATA[
                select CODE_CLASS_ID AS codeClassId
                ,CODE_ID AS codeId
                ,CODE_NAME AS codeName
                ,PARENT_ID AS parentId
                from E3_CODE
           ]]>
      </select>

      <select id="SYS100_SELECT_GROUP">
        <![CDATA[
              SELECT CODE_CLASS_ID AS CODECLASSID
                ,CODE_ID AS CODEID
                ,CODE_NAME AS CODENAME
                ,PARENT_ID AS PARENTID
                ,DESCRIPTION AS DESCRIPTION
                ,DISPLAY_SEQ AS DISPLAYSEQ
                FROM E3_CODE 
              WHERE PARENT_ID IS NULL
           ]]>
        <isNotNull property="codeId">
          <isNotEmpty property="codeId">
            <![CDATA[
            AND CODE_ID LIKE '%'|| #codeId# ||'%'
            ]]>
          </isNotEmpty>
        </isNotNull>
        <isNotNull property="codeName">
          <isNotEmpty property="codeName">
          <![CDATA[
            AND CODE_NAME LIKE '%'||#codeName#||'%'
            ]]>
          </isNotEmpty>
        </isNotNull>
        <![CDATA[
          ORDER BY CODE_NAME, CODE_ID ASC
        ]]>
      </select>

      <select id="SYS100_SELECT_CHILDREN">
        <![CDATA[
                SELECT CODE_CLASS_ID AS CODECLASSID
                ,CODE_ID AS CODEID
                ,CODE_NAME AS CODENAME
                ,PARENT_ID AS PARENTID
                ,DESCRIPTION AS DESCRIPTION
                ,DISPLAY_SEQ AS DISPLAYSEQ
                FROM E3_CODE 
                WHERE CODE_ID <> PARENT_ID
                and PARENT_ID = #codeId#
                ORDER BY DISPLAY_SEQ, CODE_NAME, CODE_ID ASC
           ]]>
      </select>

      <insert id="SYS100_INSERT">
        <![CDATA[
                INSERT INTO E3_CODE (CODE_ID, CODE_NAME, PARENT_ID, DESCRIPTION, DISPLAY_SEQ, REG_ID, REG_DATE)
                VALUES(#codeId#, #codeName#, #parentId#, #description#, #displaySeq#, #LoginedUserID#, TO_DATE(#Now#, 'YYYY-MM-DD HH24:MI:SS'))
            ]]>
      </insert>

      <update id="SYS100_UPDATE">
        <![CDATA[
                UPDATE e3_code SET 
                  CODE_NAME=#codeName#
				          , PARENT_ID=#parentId#
                  , DESCRIPTION=#description#
				          , DISPLAY_SEQ=#displaySeq#
                  , MOD_ID=#LoginedUserID#
                  , MOD_DATE=TO_DATE(#Now#, 'YYYY-MM-DD HH24:MI:SS')
                WHERE 1=1
            ]]>
        <isNotNull property="codeClassId">
          <isNotEmpty property="codeClassId">
            <![CDATA[
            AND CODE_CLASS_ID = #codeClassId#
            ]]>
          </isNotEmpty>
        </isNotNull>
        <![CDATA[
            AND CODE_ID = #codeId#
        ]]>
      </update>

      <delete id="SYS100_DELETE">
        <![CDATA[
                DELETE FROM E3_CODE
                WHERE 1=1
            ]]>
        <isNotNull property="codeClassId">
          <isNotEmpty property="codeClassId">
            <![CDATA[
            AND CODE_CLASS_ID = #codeClassId#
            ]]>
          </isNotEmpty>
        </isNotNull>
        <![CDATA[
        AND CODE_ID = #codeId#
        ]]>
      </delete>
      
    </statements>
</sqlMap>